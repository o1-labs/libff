import math
BN382_p = 5543634365110765627805495722742127385843376434033820803590214255538854698464778703795540858859767700241957783601153
BN382_q = 5543634365110765627805495722742127385843376434033820803592568747918351978899288491582778380528407187068941959692289
MODULUS_BITS = 384
LIMB_SIZES = [64, 64, 64, 64, 64, 64]
WORD_SIZE = 64
MOD_BITS = 382
CAPACITY = MODULUS_BITS - 1
REPR_SHAVE_BITS = 2
INV_p = 18446744073709551615
INV_q = 18446744073709551615
TWO_ADICITY = 67
ONE = [0xfffffffffffffff9,
       0xfffffff57fab5757,
       0x7f56ac056aeaf57f,
       0x10388572e3c2c0f5,
       0xe6ce591c2bafc343,
       0x3e03f4104144b1a]
one = 596565640619119817640570040948722104176104232228701042800312168817257919202191170334817591186065331324034272460793
inverse = 3298621403693021520254674166538938247613207941189372348401597750128415207145609847844581041878536076753325935356266
R_INV = pow(one, BN382_q - 2, BN382_q)
assert R_INV == 3298621403693021520254674166538938247613207941189372348401597750128415207145609847844581041878536076753325935356266

def limbs_to_bigint(NUMBER_LIMBS):
    offset = [0, 64, 128, 192, 256, 320]
    s = 0
    for i in range(0, len(LIMB_SIZES)):
        s += 2**offset[i] * NUMBER_LIMBS[i]
    s = R_INV * s % BN382_q
    return s

def print_name(name, num):
    s = str(num)
    print(name + " : " + " " * (140 - (len(s) + len(name))) + s)
    return

COEFF_A = 0
COEFF_A_LIMBS = [0x0, 0x0, 0x0, 0x0, 0x0, 0x0]
COEFF_B = 7
COEFF_B_LIMBS = [0xffffffffffffffcf, 0xffffffb67daf6367, 0xdc87071c715188df, 0x718ba6243a5346c8, 0x4fa46fc531ce56d5, 0x1b21bac71c8e0dbc]
COFACTOR = 1
COFACTOR_INV = 1
COFACTOR_INV_LIMBS = [0xfffffffffffffff9, 0xfffffff57fab5757, 0x7f56ac056aeaf57f, 0x10388572e3c2c0f5, 0xe6ce591c2bafc343, 0x3e03f4104144b1a]
G_GENERATOR_X = 1
G_GENERATOR_X_LIMBS = [0xfffffffffffffff9, 0xfffffff57fab5757, 0x1f8101041030381f, 0x10388572e3c2c0f8, 0xe6ce591c2bafc343, 0x3e03f4104144b1a]
G_GENERATOR_Y = 1587713460471950740217388326193312024737041813752165827005856534245539019723616944862168333942330219466268138558982
G_GENERATOR_Y_LIMBS = [0x7bbbac48dff48e8a, 0x7f0b69a418192817, 0x91be699f8043e89b, 0xb9a47acffcccc09c, 0xbd7a048e12f9984f, 0x16e7846105853ac1]

# G1
G1_COEFF_A = 0
G1_COEFF_A_LIMBS = [0x0, 0x0, 0x0, 0x0, 0x0, 0x0]
G1_COEFF_B = 14
G1_COEFF_B = [0xffffffffffffff9d,
           0xffffff6b7b52aeb7,
           0x76a537ba55d66b7f,
           0x2e8d16344c0b846b,
           0x2df8a320b2feee22,
           0x123eec4e5e4393ea]
G1_COFACTOR = 1
G1_COFACTOR_INV = 1
G1_COFACTOR_INV_LIMBS = [0xfffffffffffffff9,
                      0xfffffff57fab5757,
                      0x1f8101041030381f,
                      0x10388572e3c2c0f8,
                      0xe6ce591c2bafc343,
                      0x3e03f4104144b1a]
G1_GENERATOR_X = 1
G1_GENERATOR_X = [0xfffffffffffffff9,
                  0xfffffff57fab5757,
                  0x7f56ac056aeaf57f,
                  0x10388572e3c2c0f5,
                  0xe6ce591c2bafc343,
                  0x3e03f4104144b1a]

G1_GENERATOR_Y = 93360544046129830094757569027791679210844519762232758194920967606984287664392872848607365449491441272860487554919
G1_GENERATOR_Y_LIMBS = [0x9dfafa6eb6e5986a,
                        0x320ae00a19eea8eb,
                        0x740e245a3411fca8,
                        0x7ad3304e255f5799,
                        0x310b3464a5ff421d,
                        0x12713e4c3440dde]

# G2
# y^2 = x^3 + 14 / ((2*sqrt(7))^5) = x^3 + sqrt(7)
G2_COEFF_A = [0, 0]
# (14 / (2*sqrt(7))^5 == 0 + sqrt7 * 671741409037656549287655731709824109253980562797465531047568917158473772953357661607607074171171789249425365013734
G2_COEFF_B = [0, 671741409037656549287655731709824109253980562797465531047568917158473772953357661607607074171171789249425365013734]
G2_COEFF_B_LIMBS = [[0, 0, 0, 0, 0, 0],
                [0xaaaaaaaaaaaaaaa6,
                0xaaaaaaa3aa723a3a,
                0xaa39c8039c9ca3aa,
                0xb57b03a1ed2c80a3,
                0x99dee612c7ca822c,
                0x2957f80ad62dcbc]]

G2_COFACTOR = 5543634365110765627805495722742127385843376434033820803594923240297849259333798279370015902197046673895926135783425
G2_COFACTOR_LIMBS = [1,
                  6443243544,
                  16149412065705181664,
                  13009269933821593857,
                  8165092549055070088,
                  2595350192619816846]

# G2_COFACTOR_INV = COFACTOR^{-1} mod r
G2_COFACTOR_INV = 2771817182555382813902747861510987483969025170954974114210393735761260242342976119835350290882788898215364334190594
G2_COFACTOR_INV_LIMBS = [0x30f31f7dc6e0f46c,
                      0x77ea8678846f2b23,
                      0x1391dd7fdcdaa32,
                      0xf3afdcd2c5fbcc02,
                      0xf9573d5af51e891e,
                      0x1580839fc48bbede]

# Generator:
# (3519382844713541579002133617775236000337302709092053889907196608497211512910083011998063983635946531824025900302318*sqrt7 + 5091479006341624589567896397635435258574014748076809289641574502625108749078943401554928186045022840715545119724980,
# 4780208203968490754926961189497985186234872265999339695883768193648752722495923801951744797689497641942946290071424*sqrt7 + 3934462613855637686263305666415197064493526818650772586512345121679314757894509046665527945441022114959626478116310)
G2_GENERATOR_X_C0 = 5091479006341624589567896397635435258574014748076809289641574502625108749078943401554928186045022840715545119724980
G2_GENERATOR_X_C0_LIMBS = [0x2761a83ee6ccb6c6,
                           0x681d8b2b656ce886,
                           0x3540fb52bab89b4,
                           0x81e6427c08680553,
                           0xa9ccf8c26dcf6e1,
                           0x1851476ea8077fc6]

G2_GENERATOR_X_C1 = 3519382844713541579002133617775236000337302709092053889907196608497211512910083011998063983635946531824025900302318
G2_GENERATOR_X_C1_LIMBS = [0x14498e69e5b53113,
                           0xee8cd774d8d88e77,
                           0xc6f3b5ce2ace1aef,
                           0x3502bb8b846944a9,
                           0xc95e755dd7927cae,
                           0x7c0beebd73ab8f5]

G2_GENERATOR_Y_C0 = 3934462613855637686263305666415197064493526818650772586512345121679314757894509046665527945441022114959626478116310
G2_GENERATOR_Y_C0_LIMBS = [0xe8028a161e1bbc9a,
                           0x266bd5d118d75d9b,
                           0xacc76640f1e4baa9,
                           0xa70bd81b6be756f4,
                           0x5161ebf3eef9a86e,
                           0x657061a71f10b07]

G2_GENERATOR_Y_C1 = 4780208203968490754926961189497985186234872265999339695883768193648752722495923801951744797689497641942946290071424
G2_GENERATOR_Y_C1_LIMBS = [0xc981004fff54161b,
                           0x12540e2eb9d55972,
                           0xf89981d85302a29a,
                           0xb69dcab62945321d,
                           0x841115a42fc75e00,
                           0x65c141e4b7455c1]

# twist
# ate loop count
# final exponent 
# final exponent z
